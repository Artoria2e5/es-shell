<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: es bug -->
<!--X-From-R13: Rnivq [p@no <zpanoNanf.anfn.tbi> -->
<!--X-Date: Thu, 22 Sep 1994 18:30:23 &#45;0400 -->
<!--X-Message-Id: 199409222230.PAA16863@dinsdale.nas.nasa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: es bug</title>
<link rev="made" href="mailto:mcnab@nas.nasa.gov">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00758.html">Date Prev</a>][<a href="msg00760.html">Date Next</a>][<a href="msg00757.html">Thread Prev</a>][<a href="msg00760.html">Thread Next</a>][<a href="maillist.html#00759">Date Index</a>][<a href="threads.html#00759">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: es bug</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:es%40hawkwind.utcs.toronto.edu">es@hawkwind.utcs.toronto.edu</a></li>
<li><em>Subject</em>: Re: es bug</li>
<li><em>From</em>: David McNab &lt;<a href="mailto:mcnab%40nas.nasa.gov">mcnab@nas.nasa.gov</a>&gt;</li>
<li><em>Date</em>: Thu, 22 Sep 1994 18:30:17 -0400</li>
<li><em>In-reply-to</em>: Your message of Thu, 22 Sep 94 13:49:28 MDT </li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On the &quot;*/&quot; discussion with Tom Tromey:

|Let's forget all about &quot;ls&quot;.  I don't think it really comes into play
|here in any way.  Let's also forget about rmdir.

Well actually I can't forget about rmdir(1), because it's
the problem.

Let me first say that I was wrong about rmdir(1) and the
trailing &quot;/&quot;.  rmdir(1) accepts the trailing slash because
it passes its arguments (eventually) to namei(), which
ignores extraneous &quot;/&quot; characters where they don't matter.
That's why if &quot;/tmp/foo&quot; is a directory you can refer to it
as &quot;/tmp/foo/&quot; or even &quot;//tmp//foo//&quot;.

|There are two things I don't undertsand:
|
|1. Why &quot;foo/&quot; is not the same as &quot;foo/.&quot;.  After all, &quot;&quot; is the same
|   as &quot;.&quot;.  But I don't expect to get any real answer to this, and I
|   don't think it falls into es' domain anyway.

They are the same thing, sort of.  The kernel resolves
pathnames using the namei() routine, which returns an
inumber for the specified path.  So:

  namei(&quot;/foo&quot;) == namei(&quot;/foo/.&quot;) == namei(&quot;//tmp/foo/&quot;)

The &quot;*/.&quot; solution is the elegant and correct solution in
almost all cases, because most system calls (the eventual
recipients of the pathnames specified on the command line)
use namei() to resolve the pathname to an inode.  Hence
&quot;foo/&quot; and &quot;foo&quot; and &quot;foo/.&quot; are identical.  Except that to
rmdir(2) they are not.

Actually this is quite interesting in a pedantic way.
rmdir(2) prevents you from removing &quot;the '.' entry of a
directory&quot;.  This implies that rather than simply calling
namei() to resolve the pathname and then unlinking the
directory entry, rmdir(2) is doing its own check on the
path (otherwise it wouldn't know you were trying to remove
the &quot;.&quot; entry).

I don't know why rmdir(2) would want to do this.  Of course
it also prevents you from removing your current directory,
which doesn't make sense either -- if I can remove someone
else's current directory why can't I remove my own?  As far
as I can tell the grad student who implemented rmdir(2) at
Berkeley botched it up.  

I'm guessing that both pieces of strangeness have something
to do with supporting networked file systems.  If anyone's
interested I'll try and find out.

|2. Why the expansion of &quot;*/&quot; is not a bug any way you look at it.
|   There are two cases: on my machine, &quot;*/&quot; expands into what is
|   clearly garbage (aside: the example you give does do the right
|   thing -- it expands to &quot;h*&quot;).  Case 2: on your machine, &quot;*/&quot;
|   presumably expands to &quot;*/&quot;.  Isn't this inconsistency bothersome?

What inconsistency?

; cd /tmp; mkdir foo; cd foo; mkdir x y; touch a b; ls -F
a   b   x/   y/
; echo *h
*h
; echo */
*/
;

Looks consistent to me.  Not very helpful, mind you, but
consistent.

Neither case is very satisfying, though.

Sorry to squander all this bandwidth.  I'll shut up now.

David McNab
Parallel Systems Support
CSC at NAS, NASA/Ames

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00758.html">Re: es bug</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00760.html">es on Solaris</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00757.html">Re: es bug</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00760.html">es on Solaris</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00759"><strong>Date</strong></a></li>
<li><a href="threads.html#00759"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
