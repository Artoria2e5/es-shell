<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: tilde operator -->
<!--X-From-R13: Vnenyq Vnapur&#45;Ayfra <unapurNzngu.agah.ab> -->
<!--X-Date: Mon, 14 Dec 1998 20:34:57 &#45;0500 -->
<!--X-Message-Id: 19981212134128O.hanche@math.ntnu.no -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 199812112230.QAA16086@supra.rsch.comm.mot.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: tilde operator</title>
<link rev="made" href="mailto:hanche@math.ntnu.no">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00990.html">Date Prev</a>][<a href="msg00992.html">Date Next</a>][<a href="msg00990.html">Thread Prev</a>][<a href="msg00993.html">Thread Next</a>][<a href="maillist.html#00991">Date Index</a>][<a href="threads.html#00991">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: tilde operator</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:es%40hawkwind.utcs.toronto.edu">es@hawkwind.utcs.toronto.edu</a></li>
<li><em>Subject</em>: Re: tilde operator</li>
<li><em>From</em>: Harald Hanche-Olsen &lt;<a href="mailto:hanche%40math.ntnu.no">hanche@math.ntnu.no</a>&gt;</li>
<li><em>Date</em>: Sat, 12 Dec 1998 07:41:28 -0500</li>
<li><em>In-reply-to</em>: Your message of &quot;Fri, 11 Dec 1998 17:30:37 -0500&quot;	&lt;<a href="msg00990.html">199812112230.QAA16086@supra.rsch.comm.mot.com</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00990.html">199812112230.QAA16086@supra.rsch.comm.mot.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>- &quot;Loren J. Rittle&quot; &lt;rittle@supra.rsch.comm.mot.com&gt;:

| I have no idea if any gurus still read this mailing list, but...

They do.  i won't lay any claim to guruhood myself, but as a long-time
es user I think I can give a qualified answer to this one.

| Is the following correct behavior under es?

The short answer is yes.

| S rittle@supra; echo &lt;={~ x1 x*}
| 0
| S rittle@supra; h=x*; echo &lt;={~ x1 $h}
| 1
| S rittle@supra; h=x1; echo &lt;={~ x1 $h}
| 0
| 
| It looks like patterns may be stored in variables, but wildcard
| patterns are not allowed (or working) when stored in variables.

That's right.  The assignment h=x* is a bit dangerous by the way:  If
any files in the current directory have names beginning with `x', h
will contain the list of these file names.  Otherwise, the assignment
is equivalent to h='x*' and so {~ x1 $h} is the same as {~ x1 'x*'}
which does not match.  You're really asking for a match with a literal
* here.

How to do what you want depends a lot on your circumstances.  A very
simple solution is

; fn xmatcher {~ $* x*}
; echo &lt;={xmatcher x1}
0
; echo &lt;={xmatcher y1}
1

But this does not help much if the pattern is coming from user input,
or if you wish to use it in several different contexts without typing
it several times.  In this case there is no way around using eval.

Beware:  Here be dragons.  Bourne shell programmers often need to use
eval due to the limited capabilities of sh.  This leads to obscure
programs with equally obscure bugs.  With es, you need to use eval
much less often, but when you do, as you do in this case, the result
can be equally hard to understand.

I include some experimental code I made a long time ago.  I haven't
used it much, so I am not too sure how solid it is.  But here it is,
for you to study.  Perhaps you can use these ideas to solve your own
problem.

## wild-match
#  Example usage:
#  wild-match '*.c' foo  ==  foo @{~~ $1 *.c} *.c
fn wild-match w fun {$fun &lt;={eval 'I @{~~ $1 ' ^ $w ^ '}' $w}}

## wild-foreach
#  Example:  wild-foreach '*.C' @ f b{mv $f $b^.cc}
#            renames *.C to *.cc
#  Example:  wild-foreach '*-*' @ f b c {mv $f $c^-^$b}
#            renames foo-bar to bar-foo etc.
fn wild-foreach w fun {
  wild-match ( $w
               @ matcher files {for (f=$files) $fun $f &lt;={$matcher $f}})}

Hmm, looking at it now, I find this kind of hard to read myself.
Well, haven't got the time to try to explain it right now.
I hope you can make some sense out of it:  Just take it slow and
figure out how the examples are evaluated.  Good luck.

- Harald

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00993" href="msg00993.html">Re: tilde operator</a></strong>
<ul><li><em>From:</em> &quot;Loren J. Rittle&quot; &lt;rittle@supra.rsch.comm.mot.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00990" href="msg00990.html">tilde operator</a></strong>
<ul><li><em>From:</em> &quot;Loren J. Rittle&quot; &lt;rittle@supra.rsch.comm.mot.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00990.html">tilde operator</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00992.html">Re: tilde operator</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00990.html">tilde operator</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00993.html">Re: tilde operator</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00991"><strong>Date</strong></a></li>
<li><a href="threads.html#00991"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
