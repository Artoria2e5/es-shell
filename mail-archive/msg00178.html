<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: es memory requirements -->
<!--X-From-R13: Bnhy Vnnue <unnueNzi.hf.nqbor.pbz> -->
<!--X-Date: Tue, 5 Jan 1993 16:59:09 &#45;0500 -->
<!--X-Message-Id: 9301052154.AA00222@utopia.mv.us.adobe.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: es memory requirements</title>
<link rev="made" href="mailto:haahr@mv.us.adobe.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00177.html">Date Prev</a>][<a href="msg00179.html">Date Next</a>][<a href="msg00177.html">Thread Prev</a>][<a href="msg00179.html">Thread Next</a>][<a href="maillist.html#00178">Date Index</a>][<a href="threads.html#00178">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: es memory requirements</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Donn Cave &lt;<a href="mailto:donn%40u.washington.edu">donn@u.washington.edu</a>&gt;</li>
<li><em>Subject</em>: Re: es memory requirements</li>
<li><em>From</em>: Paul Haahr &lt;<a href="mailto:haahr%40mv.us.adobe.com">haahr@mv.us.adobe.com</a>&gt;</li>
<li><em>Date</em>: Tue, 5 Jan 1993 16:54:25 -0500</li>
<li><em>Cc</em>: es mailing list &lt;<a href="mailto:es%40hawkwind.utcs.toronto.edu">es@hawkwind.utcs.toronto.edu</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&gt; I brought up es &quot;in production&quot; today on a fairly large system, and the
&gt; good news is that it seems to be working fine - have not heard one complaint
&gt; about anything breaking.  The application in question runs under 400 lines
&gt; of es code, so we're not talking about a mammoth program.

still, it's the largest extant es program.  i'm glad to hear that it's working.

can you say anything about speed relative to rc?  i would expect performance to be  
comparable.

&gt; The bad news is that it's using 3 to 4 times as much memory as rc did, to
&gt; do pretty much the same thing.  That puts it almost in a class with perl.
&gt; Most of the memory is allocated at run time - the compiled binary sizes are
&gt; pretty comparable with rc.

we haven't yet profiled memory usage in es, and don't even have real mechanisms at  
our fingertips for giving back info on es's dynamic memory usage patterns.  my  
guess is that while we allocate a fair amount of memory, working sets are not much  
larger than working sets in rc.  more data is necessary.  (we should probably add  
an extra GCINFO compile-time option for reporting amounts of live data.)

&gt; I'm probably going to have to pull the es code and restore rc, my colleagues
&gt; here are getting pretty uptight over the memory (we apparently had some
&gt; low on memory problems this morning at only around 300 users, and we expect
&gt; more like 500 when things pick up.)

does sound bad.  when you say low on memory, do you mean low on swap space or do  
you mean lots of thrashing?  the former is not that surprising (300-500 users!!!),  
the latter is more disturbing.

&gt; What I'm wondering, since I faintly recall that es uses garbage collection,
&gt; would it be possible to influence the collection algorithm?  The application
&gt; tends to create a lot of functions and lists and then delete them all at once,
&gt; and I'm thinking it might be possible to do something, along with deleting,
&gt; that would allow the space to be reclaimed for the next batch of functions.  


deleting them does free them up, the next time a collection is done.  the  
allocator requires free memory to be contiguous (it's a copying collector), so  
knowing that some things are free already really doesn't help.

could it be that some temporary variables (with global scope) still point at the  
dead values?

&gt; (When I say &quot;delete&quot;, I mean assign a value of (), as in &quot;fn-oldthing = ()&quot;.)

as an aside, the easiest way to do a delete is
	var =
rather than the rc-influenced
	var = ()

back from vacation &amp; ready to hack,
paul

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00177.html">es memory requirements</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00179.html">Re: es memory requirements</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00177.html">es memory requirements</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00179.html">Re: es memory requirements</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00178"><strong>Date</strong></a></li>
<li><a href="threads.html#00178"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
